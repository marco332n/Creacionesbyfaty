<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Disponibles - Accesorios by Faty</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* Estilo para los botones alineados */
        .cart-row { display: flex; gap: 8px; margin-bottom: 10px; }
        .btn-cart { flex: 1; } 
        
        .btn-wishlist {
            background-color: white; border: 2px solid #ff6b6b; color: #ff6b6b;
            padding: 8px 12px; border-radius: 8px; cursor: pointer; transition: 0.3s;
        }
        .btn-wishlist:hover { background-color: #ff6b6b; color: white; }

        /* EL BOTÓN DE JUGAR */
        .game-launcher-container { text-align: center; margin: 20px 0; }
        .btn-open-game {
            background: #d1acff; color: white; border: none; padding: 12px 25px;
            border-radius: 25px; font-weight: bold; cursor: pointer; transition: 0.3s;
            display: inline-flex; align-items: center; gap: 10px;
        }
        .btn-open-game:hover { background: #b085f5; transform: scale(1.05); }

        /* AJUSTE PARA MÓVIL */
        @media (max-width: 480px) { .cart-row { flex-direction: row; } }

        /* PANTALLA DEL JUEGO */
        #offline-game-container {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #f3eaff; z-index: 10000; text-align: center; padding-top: 50px;
        }
        #game-canvas {
            width: 300px; height: 150px; border-bottom: 3px solid #435D78;
            margin: 30px auto; position: relative; overflow: hidden; background: white; border-radius: 10px;
        }
        #player-monito {
            width: 45px; height: 45px; position: absolute; bottom: 0; left: 30px;
            transition: bottom 0.3s ease-in-out;
        }
        #cactus {
            width: 25px; height: 35px; background: #ff6b6b;
            position: absolute; bottom: 0; right: -50px; border-radius: 5px;
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <div class="logo-wrapper">
                <img src="logotipo.png.png" alt="Logo">
                <div class="title-container">
                    <h1>Accesorios</h1>
                    <h2>by faty</h2>
                </div>
            </div>
            <div class="right-group">
                <div class="icons-container">
                    <a href="index.html" class="icon-link"><i class="fa-solid fa-house"></i></a>
                    <a href="login.html" class="icon-link" id="user-link"><i class="fa-regular fa-user"></i></a>
                    <a href="https://goo.gl/maps/uytQGQUzdPxbK42b9" class="icon-link" target="_blank"><i class="fa-solid fa-location-dot"></i></a>
                    <a href="carrito.html" style="text-decoration: none;">
                        <div class="cart-wrapper">
                            <i class="fa-solid fa-cart-shopping"></i>
                            <span class="cart-badge" id="cart-count">0</span>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </header>

    <main>
        <h3 class="section-title">Productos Disponibles</h3>

        <div class="game-launcher-container">
            <button class="btn-open-game" onclick="abrirJuego()">
                <i class="fa-solid fa-gamepad"></i> ¡Jugar Mini Juego!
            </button>
        </div>
        
        <section id="monos-ninos" class="products-section">
            <h3 class="products-title">Moños para Niños</h3>
            <div class="products-grid">
                
                <div class="product-card">
                    <div class="product-image"><img src="moño-1.png.png" alt="Moño 1"></div>
                    <div class="product-info">
                        <h5>Moño con aplique 1</h5>
                        <div class="product-buttons">
                            <div class="cart-row">
                                <button class="btn-cart" data-name="Moño con aplique 1" data-price="25000">Añadir al Carrito</button>
                                <button class="btn-wishlist" data-name="Moño con aplique 1" data-price="25000"><i class="fa-regular fa-heart"></i></button>
                            </div>
                            <a href="https://wa.me/595986898428?text=Hola!%20Moño%201" class="btn-whatsapp" target="_blank"><i class="fab fa-whatsapp"></i> WhatsApp</a>
                        </div>
                    </div>
                </div>

                <div class="product-card">
                    <div class="product-image"><img src="moño-2.png.png" alt="Moño 2"></div>
                    <div class="product-info">
                        <h5>Moño con aplique 2</h5>
                        <div class="product-buttons">
                            <div class="cart-row">
                                <button class="btn-cart" data-name="Moño con aplique 2" data-price="25000">Añadir al Carrito</button>
                                <button class="btn-wishlist" data-name="Moño con aplique 2" data-price="25000"><i class="fa-regular fa-heart"></i></button>
                            </div>
                            <a href="https://wa.me/595986898428?text=Hola!%20Moño%202" class="btn-whatsapp" target="_blank"><i class="fab fa-whatsapp"></i> WhatsApp</a>
                        </div>
                    </div>
                </div>

                <div class="product-card">
                    <div class="product-image"><img src="moño-3.png.png" alt="Moño 3"></div>
                    <div class="product-info">
                        <h5>Moño con aplique 3</h5>
                        <div class="product-buttons">
                            <div class="cart-row">
                                <button class="btn-cart" data-name="Moño con aplique 3" data-price="30000">Añadir al Carrito</button>
                                <button class="btn-wishlist" data-name="Moño con aplique 3" data-price="30000"><i class="fa-regular fa-heart"></i></button>
                            </div>
                            <a href="https://wa.me/595986898428?text=Hola!%20Moño%203" class="btn-whatsapp" target="_blank"><i class="fab fa-whatsapp"></i> WhatsApp</a>
                        </div>
                    </div>
                </div>

                <div class="product-card">
                    <div class="product-image"><img src="moño-4.png.png" alt="Moño 4"></div>
                    <div class="product-info">
                        <h5>Moño con aplique 4</h5>
                        <div class="product-buttons">
                            <div class="cart-row">
                                <button class="btn-cart" data-name="Moño con aplique 4" data-price="28000">Añadir al Carrito</button>
                                <button class="btn-wishlist" data-name="Moño con aplique 4" data-price="28000"><i class="fa-regular fa-heart"></i></button>
                            </div>
                            <a href="https://wa.me/595986898428?text=Hola!%20Moño%204" class="btn-whatsapp" target="_blank"><i class="fab fa-whatsapp"></i> WhatsApp</a>
                        </div>
                    </div>
                </div>

                <div class="product-card">
                    <div class="product-image"><img src="moño-5.png.png" alt="Moño 5"></div>
                    <div class="product-info">
                        <h5>Moño con aplique 5</h5>
                        <div class="product-buttons">
                            <div class="cart-row">
                                <button class="btn-cart" data-name="Moño con aplique 5" data-price="35000">Añadir al Carrito</button>
                                <button class="btn-wishlist" data-name="Moño con aplique 5" data-price="35000"><i class="fa-regular fa-heart"></i></button>
                            </div>
                            <a href="https://wa.me/595986898428?text=Hola!%20Moño%205" class="btn-whatsapp" target="_blank"><i class="fab fa-whatsapp"></i> WhatsApp</a>
                        </div>
                    </div>
                </div>

            </div>
        </section>
    </main>

    <div id="offline-game-container">
        <h2 style="color:#435D78;">Mini Juego Faty</h2>
        <div id="game-canvas">
            <div id="player-monito"><img src="logotipo.png.png" style="width:100%; height:100%;"></div>
            <div id="cactus"></div>
        </div>
        <div style="font-size: 24px; font-weight: bold; color: #435D78; margin: 15px 0;">
            PUNTOS: <span id="score-val">0</span>
        </div>
        <button onclick="cerrarJuego()" style="padding:12px 25px; background:#435D78; color:white; border:none; border-radius:20px; cursor:pointer;">Volver a la Tienda</button>
    </div>

    <script>
        let puntos = 0;
        let saltando = false;
        let juegoActivo = false;
        let bucleJuego;

        function abrirJuego() { document.getElementById('offline-game-container').style.display = 'block'; iniciarJuego(); }
        function cerrarJuego() { document.getElementById('offline-game-container').style.display = 'none'; clearInterval(bucleJuego); juegoActivo = false; }

        function saltar() {
            const player = document.getElementById('player-monito');
            if (saltando || !player) return;
            saltando = true;
            player.style.bottom = "90px";
            setTimeout(() => { if(player) player.style.bottom = "0"; setTimeout(() => { saltando = false; }, 300); }, 400);
        }

        function iniciarJuego() {
            if (juegoActivo) return;
            juegoActivo = true;
            const cactus = document.getElementById('cactus');
            const scoreVal = document.getElementById('score-val');
            puntos = 0; scoreVal.innerText = "0";
            let cactusPos = -50;
            bucleJuego = setInterval(() => {
                cactusPos += 6;
                if (cactusPos > 330) { cactusPos = -50; puntos++; scoreVal.innerText = puntos; }
                cactus.style.right = cactusPos + "px";
                let playerBottom = parseInt(window.getComputedStyle(document.getElementById('player-monito')).getPropertyValue("bottom"));
                if (cactusPos > 230 && cactusPos < 265 && playerBottom < 35) {
                    alert("¡Chocaste! Puntos: " + puntos);
                    puntos = 0; scoreVal.innerText = "0"; cactusPos = -50;
                }
            }, 20);
        }

        document.addEventListener('DOMContentLoaded', () => {
            const nombre = localStorage.getItem('usuarioLogueado');
            if (localStorage.getItem('isLoggedIn') === 'true' && nombre) {
                document.getElementById('user-link').innerHTML = `<span style="color: white; font-weight: bold; font-size: 13px;">Hola, ${nombre}</span>`;
            }
            window.addEventListener('offline', () => { abrirJuego(); });
            document.addEventListener('keydown', (e) => { if(e.code === "Space") { e.preventDefault(); saltar(); } });
            document.getElementById('offline-game-container').addEventListener('touchstart', (e) => { if(e.target.tagName !== 'BUTTON') { e.preventDefault(); saltar(); } }, {passive: false});

            // Carrito
            let carrito = JSON.parse(localStorage.getItem('carrito')) || [];
            let favoritos = JSON.parse(localStorage.getItem('favoritos')) || [];
            const badge = document.getElementById('cart-count');
            const updateBadge = () => { badge.innerText = carrito.reduce((s, i) => s + i.cantidad, 0); };

            document.querySelectorAll('.btn-cart').forEach(b => {
                b.addEventListener('click', () => {
                    const n = b.getAttribute('data-name');
                    const p = parseInt(b.getAttribute('data-price'));
                    const ex = carrito.find(i => i.nombre === n);
                    if(ex) ex.cantidad++; else carrito.push({nombre:n, precio:p, cantidad:1});
                    localStorage.setItem('carrito', JSON.stringify(carrito));
                    updateBadge();
                    b.innerText = "¡Añadido! ✓"; setTimeout(() => b.innerText = "Añadir al Carrito", 1000);
                });
            });

            document.querySelectorAll('.btn-wishlist').forEach(b => {
                b.addEventListener('click', () => {
                    const n = b.getAttribute('data-name');
                    if (!favoritos.find(i => i.nombre === n)) {
                        favoritos.push({ nombre: n });
                        localStorage.setItem('favoritos', JSON.stringify(favoritos));
                        b.style.backgroundColor = "#ff6b6b"; b.style.color = "white";
                    }
                });
            });
            updateBadge();
        });
    </script>
</body>
</html>